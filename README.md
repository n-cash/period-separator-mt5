
# Esto es un separador de períodos ajustable de código abierto (open source) para Metatrader 5.

Su función: separar los períodos. Exactamente igual a como lo hace el separador de períodos nativo de metatrader, pero con una diferencia. Lo hace ajustando los períodos a las aperturas estándard del horario regional, Eastern Standard Time (US & Canada), ajustando por Daylight Savings.

Hasta hace poco no contábamos con un camino para automatizar el cálculo del cambio de horarios entre hora de invierno y hora de verano, o Daylight Savings. Lo común en esta clase de separadores de períodos ajustables era que se fijase un input en la configuración del indicador, que marcase cuántas horas de desplazamiento (offset) quisiéramos que hubieran entre la apertura marcada por el indicador y nuestra apertura personalizada. Al ser un input fijo, el indicador se equivoca dos veces al año... cuando entramos y cuando salimos de DST. El horario de invierno/verano hace más difícil marcar con precisión las aperturas.

Se publicó una librería para mql5 con el cálculo de los comienzos y cierres de DST americano y europeo. Este indicador actualmente se enfoca sobre el segmento DST americano de esa librería. La herramienta pide que pongamos como input cuál es el horario regional del servidor que estamos utilizando, o el metatrader de nuestro broker, y hace el cálculo de cuánto es necesario desplazar las líneas de apertura para llegar a las aperturas EST del mercado que queremos delimitar. Ajustando el offset cuando entramos y salimos de DST para que a nivel histórico el indicador marque correctamente todos sus dibujos.

En algunos brokers el DST se sirve a nivel del servidor, es decir, el horario "se acomoda solo" y no necesitamos que el indicador repita la tarea. Para esto se implementó también un toggle, que nos brinda la opción de encendido/apagado del offset. Con la idea de lograr hacer que el indicador sea lo más universal posible entre distintas terminales de metatrader.

Ejemplo: Agregamos el indicador sobre nuestra pantalla, le indicamos el horario de nuestro servidor. Supongamos que es GMT +2. También le decimos si deseamos o no deseamos ajustar por DST. El indicador calculará cuánto le queda para llegar a UTC 0, y decidirá según el toggle y acorde con las fechas pautadas por la librería si desplazar las líneas una hora para corregir en los meses del año ya pintados previos, cuando llegamos al período DST.

Así, logramos que el indicador marque correctamente la medianoche New York todo el año, con precisión histórica (cuenta con el cálculo retrospectivo de DST hacia el año 2007), y sin necesidad de reajustar manualmente.

## Un detalle importante.
El toggle funciona OK hasta donde se probó, pero es posible que existan imprecisiones en el marcado con distintos brokers. Porque tenemos muchísima variedad de brokeres que sirven terminales de metatrader con horarios propios, es complicado hacer que un solo indicador funcione perfectamente...
- Ejemplo: Tenemos al indicador marcando correctamente alineadas las aperturas de los últimos cinco años, pero a partir del 6to año y hacia atrás, al parecer el servidor todavía no ajustaba su horario regional para coincidir con DST. Entonces tendríamos una delimitación histórica de las medianoches que se desalinearía a partir de ese 6to año. Porque no contamos con una lógica donde podamos inputar años específicos para eximir del offset (hay un toggle sobre si ajustar o no, pero no un termino medio entre si ajustar o no ajustar determinados años), si miramos el suficiente tiempo hacia atrás, es posible que en algunos brokers no tengamos la línea pintada perfectamente.
- Porque lo dicho arriba es un problema más bien pertinente a personas que quieren hacer un testing de sistemas automatizados con inputs horarios, y creo que esa gente está mucho más capacitada que yo para atender a este problema, por el momento no tengo mucho interés en continuar refinando el indicador.
- Ejemplo 2: La librería cuenta con ajustes regionales DST europeos, el indicador no los toma en cuenta. Simplemente ajusta por DST americano.
